% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PTMN.R
\name{PTMN}
\alias{PTMN}
\title{Plant Trait Multilayer Network Analysis}
\usage{
PTMN(
  traits_matrix,
  layers_list,
  rThres = 0.2,
  pThres = 0.05,
  method = "pearson",
  phylo_correction = FALSE,
  phylo_tree = NULL
)
}
\arguments{
\item{traits_matrix}{A data frame or matrix containing trait values where rows
represent species and columns represent traits. Row names should match the
tip labels in the phylogenetic tree when phylogenetic correction is used.}

\item{layers_list}{A named list where each element contains the names of traits
belonging to that layer. Names of the list elements represent layer names.}

\item{rThres}{Numeric. Correlation threshold for filtering weak correlations.
Correlations with absolute values below this threshold are set to zero.
Default is 0.2.}

\item{pThres}{Numeric. P-value threshold for statistical significance after
FDR correction. Correlations with p-values above this threshold are excluded.
Default is 0.05.}

\item{method}{Character. Correlation method to use. Either "pearson" or
"spearman". Default is "pearson".}

\item{phylo_correction}{Logical. Whether to apply phylogenetic correction
using phylogenetic independent contrasts. Default is FALSE.}

\item{phylo_tree}{A phylo object from the ape package. Required when
phylo_correction = TRUE. Should contain all species present in traits_matrix.}
}
\value{
A data frame containing the network edges with the following columns:
\itemize{
\item \code{node.from}: Name of the source trait
\item \code{layer.from}: Layer name of the source trait
\item \code{node.to}: Name of the target trait
\item \code{layer.to}: Layer name of the target trait
\item \code{correlation}: Correlation coefficient between the traits
}
Returns an empty data frame with the same structure if no significant
correlations are found.
}
\description{
Constructs a phylogenetic trait multilayer network by calculating correlations
between traits while accounting for phylogenetic relationships. The function
creates a network where nodes represent traits organized into different layers,
and edges represent significant correlations between traits.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates input parameters and data consistency
\item Calculates correlation matrix using standard methods or phylogenetic
independent contrasts
\item Filters correlations based on correlation and p-value thresholds
\item Applies FDR correction to p-values
\item Constructs an igraph network object
\item Maps traits to their respective layers
\item Returns edge list with layer information
}

When phylogenetic correction is enabled, the function uses phylogenetic
independent contrasts to account for the non-independence of species data
due to shared evolutionary history.
}
\examples{
\dontrun{
# Load example data
data(forest_invader_tree)
data(forest_invader_traits)
traits <- forest_invader_traits[, 6:73]

# Define trait layers
layers <- list(
  shoot_dynamics = c("LeafDuration", "LeafFall50", "LeafRate_max",
                     "Chl_shade50", "LAgain", "FallDuration",
                     "LeafOut", "Chl_sun50", "EmergeDuration",
                     "LeafTurnover"),
  leaf_structure = c("PA_leaf", "Mass_leaf", "Lifespan_leaf",
                     "Thick_leaf", "SLA", "Lobe", "LDMC",
                     "Stomate_size", "Stomate_index"),
  leaf_metabolism = c("J_max", "Vc_max", "Asat_area", "CC_mass",
                      "LSP", "AQY", "CC_area", "Rd_area",
                      "Asat_mass", "WUE", "Rd_mass", "PNUE"),
  leaf_chemistry = c("N_area", "Chl_area", "DNA", "Phenolics",
                     "Cellulose", "N_mass", "N_litter", "Chl_ab",
                     "Chl_mass", "N_res", "C_litter", "C_area",
                     "C_mass", "Ash", "Lignin", "Solubles",
                     "Decomp_leaf", "Hemi"),
  root = c("NPP_root", "SS_root", "SRL", "RTD", "RDMC",
           "NSC_root", "Decomp_root", "Starch_root",
           "C_root", "N_root", "Lignin_root"),
  stem = c("Latewood_diam", "Metaxylem_diam", "Earlywood_diam",
           "NSC_stem", "Vessel_freq", "SS_stem", "Cond_stem",
           "Starch_stem")
)
# Run PTMN analysis without phylogenetic correction
PTMN(traits, layers_list = layers, method = "pearson")

# Run PTMN analysis with phylogenetic correction
PTMN(traits, layers_list = layers, method = "pearson",
     phylo_correction = TRUE, phylo_tree = forest_invader_tree)
}

}
